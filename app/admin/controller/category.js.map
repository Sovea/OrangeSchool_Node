{
    "version": 3,
    "sources": [
        "../../../src/admin/controller/category.js"
    ],
    "names": [
        "_asyncToGenerator",
        "fn",
        "gen",
        "apply",
        "arguments",
        "Promise",
        "resolve",
        "reject",
        "step",
        "key",
        "arg",
        "info",
        "value",
        "error",
        "done",
        "then",
        "err",
        "Base",
        "require",
        "module",
        "exports",
        "indexAction",
        "_this",
        "model",
        "data",
        "where",
        "is_show",
        "order",
        "select",
        "topCategory",
        "filter",
        "item",
        "parent_id",
        "categoryList",
        "map",
        "level",
        "push",
        "child",
        "id",
        "success",
        "topCategoryAction",
        "_this2",
        "secCategoryAction",
        "_this6",
        "infoAction",
        "_this3",
        "get",
        "find",
        "storeAction",
        "_this4",
        "isPost",
        "values",
        "post",
        "icon_url",
        "img_url",
        "front_desc",
        "front_name",
        "type",
        "update",
        "add",
        "destoryAction",
        "_this5",
        "limit",
        "delete"
    ],
    "mappings": "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",
    "file": "../../../src/admin/controller/category.js",
    "sourcesContent": [
        "function _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\r\n\r\nconst Base = require('./base.js');\r\n\r\nmodule.exports = class extends Base {\r\n  /**\r\n   * index action\r\n   * @return {Promise} []\r\n   */\r\n  indexAction() {\r\n    var _this = this;\r\n\r\n    return _asyncToGenerator(function* () {\r\n      const model = _this.model('category');\r\n      const data = yield model.where({ is_show: 1 }).order(['sort_order ASC']).select();\r\n      const topCategory = data.filter(function (item) {\r\n        return item.parent_id === 0;\r\n      });\r\n      const categoryList = [];\r\n      topCategory.map(function (item) {\r\n        item.level = 1;\r\n        categoryList.push(item);\r\n        data.map(function (child) {\r\n          if (child.parent_id === item.id) {\r\n            child.level = 2;\r\n            categoryList.push(child);\r\n          }\r\n        });\r\n      });\r\n      return _this.success(categoryList);\r\n    })();\r\n  }\r\n\r\n  topCategoryAction() {\r\n    var _this2 = this;\r\n\r\n    return _asyncToGenerator(function* () {\r\n      const model = _this2.model('category');\r\n      const data = yield model.where({ parent_id: 0 }).order(['id ASC']).select();\r\n\r\n      return _this2.success(data);\r\n    })();\r\n  }\r\n  secCategoryAction() {\r\n    var _this6 = this;\r\n    return _asyncToGenerator(function* () {\r\n      const model = _this6.model('category');\r\n      const data = yield model.where({ parent_id: ['!=',0] }).order(['id ASC']).select();\r\n      return _this6.success(data);\r\n    })();\r\n  }\r\n  infoAction() {\r\n    var _this3 = this;\r\n\r\n    return _asyncToGenerator(function* () {\r\n      const id = _this3.get('id');\r\n      const model = _this3.model('category');\r\n      const data = yield model.where({ id: id }).find();\r\n\r\n      return _this3.success(data);\r\n    })();\r\n  }\r\n\r\n  storeAction() {\r\n    var _this4 = this;\r\n\r\n    return _asyncToGenerator(function* () {\r\n      if (!_this4.isPost) {\r\n        return false;\r\n      }\r\n      \r\n      const values = _this4.post();\r\n      const id = _this4.post('id');\r\n      if(_this4.post('parent_id')!=0){\r\n        values.level = 'L2';\r\n      }else{\r\n        values.level = 'L1';\r\n      }\r\n      if(!values.icon_url){\r\n        values.icon_url = '';\r\n      }\r\n      if(!values.img_url){\r\n        values.img_url = '';\r\n      }\r\n      values.front_desc = values.front_name;\r\n      values.type=0;\r\n      const model = _this4.model('category');\r\n      values.is_show = values.is_show ? 1 : 0;\r\n      if (id > 0) {\r\n        yield model.where({ id: id }).update(values);\r\n      } else {\r\n        delete values.id;\r\n        yield model.add(values);\r\n      }\r\n      return _this4.success(values);\r\n    })();\r\n  }\r\n\r\n  destoryAction() {\r\n    var _this5 = this;\r\n\r\n    return _asyncToGenerator(function* () {\r\n      const id = _this5.post('id');\r\n      yield _this5.model('category').where({ id: id }).limit(1).delete();\r\n      // TODO 删除图片\r\n\r\n      return _this5.success();\r\n    })();\r\n  }\r\n};\r\n//# sourceMappingURL=category.js.map"
    ]
}