{
    "version": 3,
    "sources": [
        "../../../src/api/controller/order.js"
    ],
    "names": [
        "_asyncToGenerator",
        "fn",
        "gen",
        "apply",
        "arguments",
        "Promise",
        "resolve",
        "reject",
        "step",
        "key",
        "arg",
        "info",
        "value",
        "error",
        "done",
        "then",
        "err",
        "Base",
        "require",
        "moment",
        "module",
        "exports",
        "listAction",
        "_this",
        "orderList",
        "model",
        "where",
        "user_id",
        "getLoginUserId",
        "page",
        "countSelect",
        "newOrderList",
        "item",
        "data",
        "goodsList",
        "order_id",
        "id",
        "select",
        "goodsCount",
        "forEach",
        "v",
        "number",
        "order_status_text",
        "getOrderStatusText",
        "handleOption",
        "getOrderHandleOption",
        "push",
        "success",
        "detailAction",
        "_this2",
        "orderId",
        "get",
        "orderInfo",
        "find",
        "think",
        "isEmpty",
        "fail",
        "province_name",
        "province",
        "getField",
        "city_name",
        "city",
        "district_name",
        "district",
        "full_region",
        "latestExpressInfo",
        "getLatestOrderExpress",
        "express",
        "orderGoods",
        "add_time",
        "unix",
        "format",
        "final_pay_time",
        "order_status",
        "submitAction",
        "_this3",
        "addressId",
        "post",
        "checkedAddress",
        "freightPrice",
        "checkedGoodsList",
        "session_id",
        "checked",
        "goodsTotalPrice",
        "cartItem",
        "retail_price",
        "couponId",
        "couponPrice",
        "orderTotalPrice",
        "actualPrice",
        "currentTime",
        "getTime",
        "order_sn",
        "generateOrderNumber",
        "consignee",
        "name",
        "mobile",
        "province_id",
        "city_id",
        "district_id",
        "address",
        "freight_price",
        "postscript",
        "coupon_id",
        "coupon_price",
        "goods_price",
        "order_price",
        "actual_price",
        "add",
        "orderGoodsData",
        "goodsItem",
        "goods_id",
        "goods_sn",
        "product_id",
        "goods_name",
        "list_pic_url",
        "market_price",
        "goods_specifition_name_value",
        "goods_specifition_ids",
        "addMany",
        "clearBuyGoods",
        "cancelAction",
        "_this5",
        "deleteinfo",
        "pay_status",
        "limit",
        "delete",
        "delete2info",
        "expressAction",
        "_this4"
    ],
    "mappings": "AAAA,SAASA,iBAAT,CAA2BC,EAA3B,EAA+B;AAAE,SAAO,YAAY;AAAE,QAAIC,MAAMD,GAAGE,KAAH,CAAS,IAAT,EAAeC,SAAf,CAAV,CAAqC,OAAO,IAAIC,OAAJ,CAAY,UAAUC,OAAV,EAAmBC,MAAnB,EAA2B;AAAE,eAASC,IAAT,CAAcC,GAAd,EAAmBC,GAAnB,EAAwB;AAAE,YAAI;AAAE,cAAIC,OAAOT,IAAIO,GAAJ,EAASC,GAAT,CAAX,CAA0B,IAAIE,QAAQD,KAAKC,KAAjB;AAAyB,SAAzD,CAA0D,OAAOC,KAAP,EAAc;AAAEN,iBAAOM,KAAP,EAAe;AAAS,SAAC,IAAIF,KAAKG,IAAT,EAAe;AAAER,kBAAQM,KAAR;AAAiB,SAAlC,MAAwC;AAAE,iBAAOP,QAAQC,OAAR,CAAgBM,KAAhB,EAAuBG,IAAvB,CAA4B,UAAUH,KAAV,EAAiB;AAAEJ,iBAAK,MAAL,EAAaI,KAAb;AAAsB,WAArE,EAAuE,UAAUI,GAAV,EAAe;AAAER,iBAAK,OAAL,EAAcQ,GAAd;AAAqB,WAA7G,CAAP;AAAwH;AAAE,OAAC,OAAOR,KAAK,MAAL,CAAP;AAAsB,KAAjW,CAAP;AAA4W,GAAta;AAAya;;AAE1c,MAAMS,OAAOC,QAAQ,WAAR,CAAb;AACA,MAAMC,SAASD,QAAQ,QAAR,CAAf;;AAEAE,OAAOC,OAAP,GAAiB,cAAcJ,IAAd,CAAmB;AAClC;;;;AAIAK,eAAa;AACX,QAAIC,QAAQ,IAAZ;;AAEA,WAAOvB,kBAAkB,aAAa;AACpC,YAAMwB,YAAY,MAAMD,MAAME,KAAN,CAAY,OAAZ,EAAqBC,KAArB,CAA2B,EAAEC,SAASJ,MAAMK,cAAN,EAAX,EAA3B,EAAgEC,IAAhE,CAAqE,CAArE,EAAwE,EAAxE,EAA4EC,WAA5E,EAAxB;AACA,YAAMC,eAAe,EAArB;AACA,WAAK,MAAMC,IAAX,IAAmBR,UAAUS,IAA7B,EAAmC;AACjC;AACAD,aAAKE,SAAL,GAAiB,MAAMX,MAAME,KAAN,CAAY,aAAZ,EAA2BC,KAA3B,CAAiC,EAAES,UAAUH,KAAKI,EAAjB,EAAjC,EAAwDC,MAAxD,EAAvB;AACAL,aAAKM,UAAL,GAAkB,CAAlB;AACAN,aAAKE,SAAL,CAAeK,OAAf,CAAuB,UAAUC,CAAV,EAAa;AAClCR,eAAKM,UAAL,IAAmBE,EAAEC,MAArB;AACD,SAFD;;AAIA;AACAT,aAAKU,iBAAL,GAAyB,MAAMnB,MAAME,KAAN,CAAY,OAAZ,EAAqBkB,kBAArB,CAAwCX,KAAKI,EAA7C,CAA/B;;AAEA;AACAJ,aAAKY,YAAL,GAAoB,MAAMrB,MAAME,KAAN,CAAY,OAAZ,EAAqBoB,oBAArB,CAA0Cb,KAAKI,EAA/C,CAA1B;;AAEAL,qBAAae,IAAb,CAAkBd,IAAlB;AACD;AACDR,gBAAUS,IAAV,GAAiBF,YAAjB;;AAEA,aAAOR,MAAMwB,OAAN,CAAcvB,SAAd,CAAP;AACD,KAtBM,GAAP;AAuBD;;AAEDwB,iBAAe;AACb,QAAIC,SAAS,IAAb;;AAEA,WAAOjD,kBAAkB,aAAa;AACpC,YAAMkD,UAAUD,OAAOE,GAAP,CAAW,SAAX,CAAhB;AACA,YAAMC,YAAY,MAAMH,OAAOxB,KAAP,CAAa,OAAb,EAAsBC,KAAtB,CAA4B,EAAEC,SAASsB,OAAOrB,cAAP,EAAX,EAAoCQ,IAAIc,OAAxC,EAA5B,EAA+EG,IAA/E,EAAxB;;AAEA,UAAIC,MAAMC,OAAN,CAAcH,SAAd,CAAJ,EAA8B;AAC5B,eAAOH,OAAOO,IAAP,CAAY,OAAZ,CAAP;AACD;;AAEDJ,gBAAUK,aAAV,GAA0B,MAAMR,OAAOxB,KAAP,CAAa,QAAb,EAAuBC,KAAvB,CAA6B,EAAEU,IAAIgB,UAAUM,QAAhB,EAA7B,EAAyDC,QAAzD,CAAkE,MAAlE,EAA0E,IAA1E,CAAhC;AACAP,gBAAUQ,SAAV,GAAsB,MAAMX,OAAOxB,KAAP,CAAa,QAAb,EAAuBC,KAAvB,CAA6B,EAAEU,IAAIgB,UAAUS,IAAhB,EAA7B,EAAqDF,QAArD,CAA8D,MAA9D,EAAsE,IAAtE,CAA5B;AACAP,gBAAUU,aAAV,GAA0B,MAAMb,OAAOxB,KAAP,CAAa,QAAb,EAAuBC,KAAvB,CAA6B,EAAEU,IAAIgB,UAAUW,QAAhB,EAA7B,EAAyDJ,QAAzD,CAAkE,MAAlE,EAA0E,IAA1E,CAAhC;AACAP,gBAAUY,WAAV,GAAwBZ,UAAUK,aAAV,GAA0BL,UAAUQ,SAApC,GAAgDR,UAAUU,aAAlF;;AAEA,YAAMG,oBAAoB,MAAMhB,OAAOxB,KAAP,CAAa,eAAb,EAA8ByC,qBAA9B,CAAoDhB,OAApD,CAAhC;AACAE,gBAAUe,OAAV,GAAoBF,iBAApB;;AAEA,YAAMG,aAAa,MAAMnB,OAAOxB,KAAP,CAAa,aAAb,EAA4BC,KAA5B,CAAkC,EAAES,UAAUe,OAAZ,EAAlC,EAAyDb,MAAzD,EAAzB;;AAEA;AACAe,gBAAUV,iBAAV,GAA8B,MAAMO,OAAOxB,KAAP,CAAa,OAAb,EAAsBkB,kBAAtB,CAAyCO,OAAzC,CAApC;AACAE,gBAAUiB,QAAV,GAAqBlD,OAAOmD,IAAP,CAAYlB,UAAUiB,QAAtB,EAAgCE,MAAhC,CAAuC,qBAAvC,CAArB;AACAnB,gBAAUoB,cAAV,GAA2BrD,OAAO,QAAP,EAAiB,OAAjB,EAA0BoD,MAA1B,CAAiC,OAAjC,CAA3B;AACA;AACA,UAAInB,UAAUqB,YAAV,KAA2B,CAA/B,EAAkC;AAChC;AACArB,kBAAUoB,cAAV,GAA2BrD,OAAO,QAAP,EAAiB,OAAjB,EAA0BoD,MAA1B,CAAiC,OAAjC,CAA3B;AACA;AACA;AACA;AACD;;AAED;AACA,YAAM3B,eAAe,MAAMK,OAAOxB,KAAP,CAAa,OAAb,EAAsBoB,oBAAtB,CAA2CK,OAA3C,CAA3B;;AAEA,aAAOD,OAAOF,OAAP,CAAe;AACpBK,mBAAWA,SADS;AAEpBgB,oBAAYA,UAFQ;AAGpBxB,sBAAcA;AAHM,OAAf,CAAP;AAKD,KAvCM,GAAP;AAwCD;;AAED;;;;AAIA8B,iBAAe;AACb,QAAIC,SAAS,IAAb;;AAEA,WAAO3E,kBAAkB,aAAa;AACpC;AACA,YAAM4E,YAAYD,OAAOE,IAAP,CAAY,WAAZ,CAAlB;AACA,YAAMC,iBAAiB,MAAMH,OAAOlD,KAAP,CAAa,SAAb,EAAwBC,KAAxB,CAA8B,EAAEU,IAAIwC,SAAN,EAA9B,EAAiDvB,IAAjD,EAA7B;AACA,UAAIC,MAAMC,OAAN,CAAcuB,cAAd,CAAJ,EAAmC;AACjC,eAAOH,OAAOnB,IAAP,CAAY,SAAZ,CAAP;AACD;AACD,YAAMuB,eAAe,IAArB;;AAEA;AACA,YAAMC,mBAAmB,MAAML,OAAOlD,KAAP,CAAa,MAAb,EAAqBC,KAArB,CAA2B,EAAEC,SAASgD,OAAO/C,cAAP,EAAX,EAAoCqD,YAAY,CAAhD,EAAmDC,SAAS,CAA5D,EAA3B,EAA4F7C,MAA5F,EAA/B;AACA,UAAIiB,MAAMC,OAAN,CAAcyB,gBAAd,CAAJ,EAAqC;AACnC,eAAOL,OAAOnB,IAAP,CAAY,OAAZ,CAAP;AACD;;AAED;AACA,UAAI2B,kBAAkB,IAAtB;AACA,WAAK,MAAMC,QAAX,IAAuBJ,gBAAvB,EAAyC;AACvCG,2BAAmBC,SAAS3C,MAAT,GAAkB2C,SAASC,YAA9C;AACD;;AAED;AACA,YAAMC,WAAWX,OAAOE,IAAP,CAAY,UAAZ,CAAjB;AACA,YAAMU,cAAc,IAApB;AACA,UAAI,CAACjC,MAAMC,OAAN,CAAc+B,QAAd,CAAL,EAA8B,CAAE;;AAEhC;AACA,YAAME,kBAAkBL,kBAAkBJ,YAAlB,GAAiCQ,WAAzD,CA3BoC,CA2BkC;AACtE,YAAME,cAAcD,kBAAkB,IAAtC,CA5BoC,CA4BQ;AAC5C,YAAME,cAAcf,OAAOgB,OAAP,EAApB;;AAEA,YAAMvC,YAAY;AAChBwC,kBAAUjB,OAAOlD,KAAP,CAAa,OAAb,EAAsBoE,mBAAtB,EADM;AAEhBlE,iBAASgD,OAAO/C,cAAP,EAFO;;AAIhB;AACAkE,mBAAWhB,eAAeiB,IALV;AAMhBC,gBAAQlB,eAAekB,MANP;AAOhBtC,kBAAUoB,eAAemB,WAPT;AAQhBpC,cAAMiB,eAAeoB,OARL;AAShBnC,kBAAUe,eAAeqB,WATT;AAUhBC,iBAAStB,eAAesB,OAVR;AAWhBC,uBAAe,IAXC;;AAahB;AACAC,oBAAY3B,OAAOE,IAAP,CAAY,YAAZ,CAdI;;AAgBhB;AACA0B,mBAAW,CAjBK;AAkBhBC,sBAAcjB,WAlBE;;AAoBhBlB,kBAAUqB,WApBM;AAqBhBe,qBAAatB,eArBG;AAsBhBuB,qBAAalB,eAtBG;AAuBhBmB,sBAAclB;AAvBE,OAAlB;;AA0BA;AACA,YAAMvC,UAAU,MAAMyB,OAAOlD,KAAP,CAAa,OAAb,EAAsBmF,GAAtB,CAA0BxD,SAA1B,CAAtB;AACAA,gBAAUhB,EAAV,GAAec,OAAf;AACA,UAAI,CAACA,OAAL,EAAc;AACZ,eAAOyB,OAAOnB,IAAP,CAAY,QAAZ,CAAP;AACD;;AAED;AACA,YAAMqD,iBAAiB,EAAvB;AACA,WAAK,MAAMC,SAAX,IAAwB9B,gBAAxB,EAA0C;AACxC6B,uBAAe/D,IAAf,CAAoB;AAClBX,oBAAUe,OADQ;AAElB6D,oBAAUD,UAAUC,QAFF;AAGlBC,oBAAUF,UAAUE,QAHF;AAIlBC,sBAAYH,UAAUG,UAJJ;AAKlBC,sBAAYJ,UAAUI,UALJ;AAMlBC,wBAAcL,UAAUK,YANN;AAOlBC,wBAAcN,UAAUM,YAPN;AAQlB/B,wBAAcyB,UAAUzB,YARN;AASlB5C,kBAAQqE,UAAUrE,MATA;AAUlB4E,wCAA8BP,UAAUO,4BAVtB;AAWlBC,iCAAuBR,UAAUQ;AAXf,SAApB;AAaD;;AAED,YAAM3C,OAAOlD,KAAP,CAAa,aAAb,EAA4B8F,OAA5B,CAAoCV,cAApC,CAAN;AACA,YAAMlC,OAAOlD,KAAP,CAAa,MAAb,EAAqB+F,aAArB,CAAmC7C,OAAO/C,cAAP,EAAnC,CAAN;;AAEA,aAAO+C,OAAO5B,OAAP,CAAe,EAAEK,WAAWA,SAAb,EAAf,CAAP;AACD,KAtFM,GAAP;AAuFD;AACDqE,iBAAe;AACb,QAAIC,SAAS,IAAb;AACA,WAAO1H,kBAAkB,aAAa;AACpC,YAAMkD,UAAUwE,OAAO7C,IAAP,CAAY,SAAZ,CAAhB;AACA,UAAIvB,MAAMC,OAAN,CAAcL,OAAd,CAAJ,EAA4B;AAC1B,eAAOwE,OAAOlE,IAAP,CAAY,OAAZ,CAAP;AACD;AACD,YAAMmE,aAAa,MAAMD,OAAOjG,KAAP,CAAa,OAAb,EAAsBC,KAAtB,CAA4B,EAACU,IAAGc,OAAJ,EAAY0E,YAAW,CAAvB,EAA5B,EAAuDC,KAAvD,CAA6D,CAA7D,EAAgEC,MAAhE,EAAzB;AACA,YAAMC,cAAc,MAAML,OAAOjG,KAAP,CAAa,aAAb,EAA4BC,KAA5B,CAAkC,EAACS,UAASe,OAAV,EAAlC,EAAsD2E,KAAtD,CAA4D,CAA5D,EAA+DC,MAA/D,EAA1B;AACA,aAAOJ,OAAO3E,OAAP,CAAe4E,UAAf,CAAP;AACD,KARM,GAAP;AASD;AACD;;;;AAIAK,kBAAgB;AACd,QAAIC,SAAS,IAAb;;AAEA,WAAOjI,kBAAkB,aAAa;AACpC,YAAMkD,UAAU+E,OAAO9E,GAAP,CAAW,SAAX,CAAhB;AACA,UAAIG,MAAMC,OAAN,CAAcL,OAAd,CAAJ,EAA4B;AAC1B,eAAO+E,OAAOzE,IAAP,CAAY,OAAZ,CAAP;AACD;AACD,YAAMS,oBAAoB,MAAMgE,OAAOxG,KAAP,CAAa,eAAb,EAA8ByC,qBAA9B,CAAoDhB,OAApD,CAAhC;AACA,aAAO+E,OAAOlF,OAAP,CAAekB,iBAAf,CAAP;AACD,KAPM,GAAP;AAQD;AAxMiC,CAApC;AA0MA",
    "file": "../../../src/api/controller/order.js",
    "sourcesContent": [
        "function _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\r\n\r\nconst Base = require('./base.js');\r\nconst moment = require('moment');\r\n\r\nmodule.exports = class extends Base {\r\n  /**\r\n   * 获取订单列表\r\n   * @return {Promise} []\r\n   */\r\n  listAction() {\r\n    var _this = this;\r\n\r\n    return _asyncToGenerator(function* () {\r\n      const orderList = yield _this.model('order').where({ user_id: _this.getLoginUserId() }).page(1, 10).countSelect();\r\n      const newOrderList = [];\r\n      for (const item of orderList.data) {\r\n        // 订单的商品\r\n        item.goodsList = yield _this.model('order_goods').where({ order_id: item.id }).select();\r\n        item.goodsCount = 0;\r\n        item.goodsList.forEach(function (v) {\r\n          item.goodsCount += v.number;\r\n        });\r\n\r\n        // 订单状态的处理\r\n        item.order_status_text = yield _this.model('order').getOrderStatusText(item.id);\r\n\r\n        // 可操作的选项\r\n        item.handleOption = yield _this.model('order').getOrderHandleOption(item.id);\r\n\r\n        newOrderList.push(item);\r\n      }\r\n      orderList.data = newOrderList;\r\n\r\n      return _this.success(orderList);\r\n    })();\r\n  }\r\n\r\n  detailAction() {\r\n    var _this2 = this;\r\n\r\n    return _asyncToGenerator(function* () {\r\n      const orderId = _this2.get('orderId');\r\n      const orderInfo = yield _this2.model('order').where({ user_id: _this2.getLoginUserId(), id: orderId }).find();\r\n\r\n      if (think.isEmpty(orderInfo)) {\r\n        return _this2.fail('订单不存在');\r\n      }\r\n\r\n      orderInfo.province_name = yield _this2.model('region').where({ id: orderInfo.province }).getField('name', true);\r\n      orderInfo.city_name = yield _this2.model('region').where({ id: orderInfo.city }).getField('name', true);\r\n      orderInfo.district_name = yield _this2.model('region').where({ id: orderInfo.district }).getField('name', true);\r\n      orderInfo.full_region = orderInfo.province_name + orderInfo.city_name + orderInfo.district_name;\r\n\r\n      const latestExpressInfo = yield _this2.model('order_express').getLatestOrderExpress(orderId);\r\n      orderInfo.express = latestExpressInfo;\r\n\r\n      const orderGoods = yield _this2.model('order_goods').where({ order_id: orderId }).select();\r\n\r\n      // 订单状态的处理\r\n      orderInfo.order_status_text = yield _this2.model('order').getOrderStatusText(orderId);\r\n      orderInfo.add_time = moment.unix(orderInfo.add_time).format('YYYY-MM-DD HH:mm:ss');\r\n      orderInfo.final_pay_time = moment('001234', 'Hmmss').format('mm:ss');\r\n      // 订单最后支付时间\r\n      if (orderInfo.order_status === 0) {\r\n        // if (moment().subtract(60, 'minutes') < moment(orderInfo.add_time)) {\r\n        orderInfo.final_pay_time = moment('001234', 'Hmmss').format('mm:ss');\r\n        // } else {\r\n        //     //超过时间不支付，更新订单状态为取消\r\n        // }\r\n      }\r\n\r\n      // 订单可操作的选择,删除，支付，收货，评论，退换货\r\n      const handleOption = yield _this2.model('order').getOrderHandleOption(orderId);\r\n\r\n      return _this2.success({\r\n        orderInfo: orderInfo,\r\n        orderGoods: orderGoods,\r\n        handleOption: handleOption\r\n      });\r\n    })();\r\n  }\r\n\r\n  /**\r\n   * 提交订单\r\n   * @returns {Promise.<void>}\r\n   */\r\n  submitAction() {\r\n    var _this3 = this;\r\n\r\n    return _asyncToGenerator(function* () {\r\n      // 获取收货地址信息和计算运费\r\n      const addressId = _this3.post('addressId');\r\n      const checkedAddress = yield _this3.model('address').where({ id: addressId }).find();\r\n      if (think.isEmpty(checkedAddress)) {\r\n        return _this3.fail('请选择收货地址');\r\n      }\r\n      const freightPrice = 0.00;\r\n\r\n      // 获取要购买的商品\r\n      const checkedGoodsList = yield _this3.model('cart').where({ user_id: _this3.getLoginUserId(), session_id: 1, checked: 1 }).select();\r\n      if (think.isEmpty(checkedGoodsList)) {\r\n        return _this3.fail('请选择商品');\r\n      }\r\n\r\n      // 统计商品总价\r\n      let goodsTotalPrice = 0.00;\r\n      for (const cartItem of checkedGoodsList) {\r\n        goodsTotalPrice += cartItem.number * cartItem.retail_price;\r\n      }\r\n\r\n      // 获取订单使用的优惠券\r\n      const couponId = _this3.post('couponId');\r\n      const couponPrice = 0.00;\r\n      if (!think.isEmpty(couponId)) {}\r\n\r\n      // 订单价格计算\r\n      const orderTotalPrice = goodsTotalPrice + freightPrice - couponPrice; // 订单的总价\r\n      const actualPrice = orderTotalPrice - 0.00; // 减去其它支付的金额后，要实际支付的金额\r\n      const currentTime = _this3.getTime();\r\n\r\n      const orderInfo = {\r\n        order_sn: _this3.model('order').generateOrderNumber(),\r\n        user_id: _this3.getLoginUserId(),\r\n\r\n        // 收货地址和运费\r\n        consignee: checkedAddress.name,\r\n        mobile: checkedAddress.mobile,\r\n        province: checkedAddress.province_id,\r\n        city: checkedAddress.city_id,\r\n        district: checkedAddress.district_id,\r\n        address: checkedAddress.address,\r\n        freight_price: 0.00,\r\n\r\n        // 留言\r\n        postscript: _this3.post('postscript'),\r\n\r\n        // 使用的优惠券\r\n        coupon_id: 0,\r\n        coupon_price: couponPrice,\r\n\r\n        add_time: currentTime,\r\n        goods_price: goodsTotalPrice,\r\n        order_price: orderTotalPrice,\r\n        actual_price: actualPrice\r\n      };\r\n\r\n      // 开启事务，插入订单信息和订单商品\r\n      const orderId = yield _this3.model('order').add(orderInfo);\r\n      orderInfo.id = orderId;\r\n      if (!orderId) {\r\n        return _this3.fail('订单提交失败');\r\n      }\r\n\r\n      // 统计商品总价\r\n      const orderGoodsData = [];\r\n      for (const goodsItem of checkedGoodsList) {\r\n        orderGoodsData.push({\r\n          order_id: orderId,\r\n          goods_id: goodsItem.goods_id,\r\n          goods_sn: goodsItem.goods_sn,\r\n          product_id: goodsItem.product_id,\r\n          goods_name: goodsItem.goods_name,\r\n          list_pic_url: goodsItem.list_pic_url,\r\n          market_price: goodsItem.market_price,\r\n          retail_price: goodsItem.retail_price,\r\n          number: goodsItem.number,\r\n          goods_specifition_name_value: goodsItem.goods_specifition_name_value,\r\n          goods_specifition_ids: goodsItem.goods_specifition_ids\r\n        });\r\n      }\r\n\r\n      yield _this3.model('order_goods').addMany(orderGoodsData);\r\n      yield _this3.model('cart').clearBuyGoods(_this3.getLoginUserId());\r\n\r\n      return _this3.success({ orderInfo: orderInfo });\r\n    })();\r\n  }\r\n  cancelAction() {\r\n    var _this5 = this;\r\n    return _asyncToGenerator(function* () {\r\n      const orderId = _this5.post('orderId');\r\n      if (think.isEmpty(orderId)) {\r\n        return _this5.fail('订单不存在');\r\n      }\r\n      const deleteinfo = yield _this5.model('order').where({id:orderId,pay_status:0}).limit(1).delete();\r\n      const delete2info = yield _this5.model('order_goods').where({order_id:orderId}).limit(1).delete();\r\n      return _this5.success(deleteinfo);\r\n    })();\r\n  }\r\n  /**\r\n   * 查询物流信息\r\n   * @returns {Promise.<void>}\r\n   */\r\n  expressAction() {\r\n    var _this4 = this;\r\n\r\n    return _asyncToGenerator(function* () {\r\n      const orderId = _this4.get('orderId');\r\n      if (think.isEmpty(orderId)) {\r\n        return _this4.fail('订单不存在');\r\n      }\r\n      const latestExpressInfo = yield _this4.model('order_express').getLatestOrderExpress(orderId);\r\n      return _this4.success(latestExpressInfo);\r\n    })();\r\n  }\r\n};\r\n//# sourceMappingURL=order.js.map"
    ]
}